+++
categories = ["Tech"]
date = "2017-05-14T21:01:17+09:00"
tags = ["Smart home"]
title = "Time Machineの容量制限"

+++

Time Capsuleをバックアップ用途だけでなく、NASとしても使いたい。
Time Machineを使うと、容量がいっぱいになるまでバックアップを取り続けてしまうので、
何らかの方法で容量を制限する必要がある。

パーティションを切って、バックアップ領域とデータ領域に分けるという方法が主流のようだ。
ただ、裏ワザ的な使い方のためあまり推奨しないという意見も多い。

そこで、別の方法を採用した。

<!--more-->

## ダミーファイルを置く

ダミーファイルを置くことで、パーティションを切ることなく、Time Machineの侵食を逃れる。
新しくデータを置きたい場合は、ダミーファイルの一部をデータと置き換えればよい。

1GBのダミーファイルを100個と、10GBのダミーファイルを10個用意して、
計200GB分のデータ領域を確保することにした。

ダミーファイルの作成は以下のコマンドを使った。

```bash
dd if=/dev/zero of=./dummy_10GB bs=1000000 count=10000
```

実際にはfor文で以下のように使う。
ネットワーク越しなのでかなり時間がかかることに注意。

```bash
cd /Volumes/TimeCapsule
for ((i=0; i < 100; i++)); do dd if=/dev/zero of=./dummy_1GB_$i bs=1000000 count=1000; done
for ((i=0; i < 10; i++)); do dd if=/dev/zero of=./dummy_10GB_$i bs=1000000 count=10000; done
```
